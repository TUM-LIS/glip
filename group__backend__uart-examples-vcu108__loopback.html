<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>glip: VCU108 UART Loopback Demo</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">glip
   &#160;<span id="projectnumber">0.1.0-dev</span>
   </div>
   <div id="projectbrief">The Generic Logic Interfacing Project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>GLIP&#160;Introduction</span></a></li>
      <li><a href="examples.html"><span>Demos</span></a></li>
      <li><a href="modules.html"><span>Documentation</span></a></li>
      <li><a href="download.html"><span>Download</span></a></li>
      <li><a href="contact.html"><span>Contact</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__backend__uart-examples-vcu108__loopback.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">VCU108 UART Loopback Demo<div class="ingroups"><a class="el" href="group__backend.html">Backends</a> &raquo; <a class="el" href="group__backend__uart.html">UART</a> &raquo; <a class="el" href="group__backend__uart-logic.html">UART FPGA Logic</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>This demo implements a loopback in the device. Also a small demo using the pushbuttons, user DIP switch and GPIO LEDs is implemented.</p>
<dl class="section note"><dt>Note</dt><dd>The VCU108 board provides only a rather slow UART chip. In theory, it should be able to provide up to 2 MBaud/s, but in our testing only speeds up to roughly 1 MBaud/s work reliably.</dd></dl>
<h2>Prerequisites </h2>
<p>For this demo you need:</p>
<ul>
<li><a href="https://www.xilinx.com/products/boards-and-kits/ek-u1-vcu108-g.html">Xilinx VCU108 Evaluation Kit</a></li>
<li><a href="http://www.xilinx.com/products/design-tools/vivado/">Xilinx Vivado</a> version 2016.3 or higher</li>
</ul>
<h2>Download and compile glip </h2>
<p>If you have not done this before you need to download and build glip: </p><pre class="fragment">git clone https://github.com/TUM-LIS/glip.git
cd glip
./autogen.sh
mkdir build; cd build
../configure --enable-uart
make
sudo make install
</pre><h2>Synthesize the design </h2>
<p>Synthesize the example design with Xilinx Vivado. </p><pre class="fragment">cd GLIP_SOURCES/src/backend_uart/logic/demo/nexys4ddr
make vivado-project
vivado vivado/vcu108.xpr
</pre><p>In vivado run the implementation and generate the bitstream.</p>
<h2>Configure the FPGA </h2>
<p>When the bitstream has been succesfully generated, open the Hardware Manager in Vivado, turn the board on and program the device.</p>
<h2>Execute the loopback measurement tool </h2>
<p>Execute the GLIP tool "Loopback Measure" that measures the loopback performance.</p>
<p>The VC108 board provides a UART to serial bridge using the a Silicon Labs CP2105 Dual USB to UART Bridge Controller. This device provides two serial ports over one USB connection. Our demo uses the <em>lower numbered</em> serial port.</p>
<p>First, prepare the connection:</p>
<ul>
<li>Connect the "USB UART" labeled Mini-USB port on the board to your PC.</li>
<li>Two new serial devices will appear, usually named <code>/dev/ttyUSB0</code> and <code>/dev/ttyUSB1</code>.</li>
<li>We use the ttyUSB device with the <em>higher</em> number, i.e. <code>/dev/ttyUSB1</code>.</li>
<li>Check with <code>ls -l /dev/ttyUSB1</code> that the file permissions allow you to read and write from this device. Otherwise use chmod to temporarily change the permissions, or use a udev rule to make these changes permanent.</li>
</ul>
<p>Now you can run the loopback measurement tool: </p><pre class="fragment">glip_loopback_measure -b uart -ospeed=921600,device=/dev/ttyUSB1
</pre><p>You should get around 75 KByte/s when running this test.</p>
<h3>Notes for debugging</h3>
<ul>
<li>We have experienced trouble with some USB hubs. If you cannot get a reliable connection to the board, try connecting the board directly to your PC.</li>
<li><p class="startli">To find the right device file, run <code>dmesg</code> after connecting the board. You should see an output like this: </p><pre class="fragment">usb 1-1.3: new full-speed USB device number 7 using ehci-pci
usb 1-1.3: New USB device found, idVendor=10c4, idProduct=ea70
usb 1-1.3: New USB device strings: Mfr=1, Product=2, SerialNumber=5
usb 1-1.3: Product: CP2105 Dual USB to UART Bridge Controller
usb 1-1.3: Manufacturer: Silicon Labs
usb 1-1.3: SerialNumber: 006277B8
cp210x 1-1.3:1.0: cp210x converter detected
usb 1-1.3: cp210x converter now attached to ttyUSB0
cp210x 1-1.3:1.1: cp210x converter detected
usb 1-1.3: cp210x converter now attached to ttyUSB1
cp210x ttyUSB1: failed to set baud rate to 300
</pre><p class="startli">The second cp210x device name is the one we're looking for, ttyUSB1 in this case. The first one, ttyUSB0 is connected to the system management chip of the VCU108 baord. You can confirm that by opening a terminal application like cutecom, set the baudrate to 115200 baud and connect to /dev/ttyUSB0. After pressing ENTER, you should see a menu of options to configure the VCU108 board. </p>
</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu May 4 2017 22:04:12 for glip by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
