<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>glip: VCU108 Cypress FX3 (USB 3.0) Loopback Demo</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">glip
   &#160;<span id="projectnumber">0.1.0-dev</span>
   </div>
   <div id="projectbrief">The Generic Logic Interfacing Project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>GLIP&#160;Introduction</span></a></li>
      <li><a href="examples.html"><span>Demos</span></a></li>
      <li><a href="modules.html"><span>Documentation</span></a></li>
      <li><a href="download.html"><span>Download</span></a></li>
      <li><a href="contact.html"><span>Contact</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__backend__cypressfx3-examples-vcu108__loopback.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">VCU108 Cypress FX3 (USB 3.0) Loopback Demo<div class="ingroups"><a class="el" href="group__backend.html">Backends</a> &raquo; <a class="el" href="group__backend__cypressfx3.html">Cypress FX3</a> &raquo; <a class="el" href="group__backend__cypressfx3-logic.html">Cypress FX3 FPGA Logic</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<h2>Prerequisites </h2>
<p>For this demo you need:</p>
<ul>
<li><a href="https://www.xilinx.com/products/boards-and-kits/ek-u1-vcu108-g.html">Xilinx Virtex UltraScale FPGA VCU108 Evaluation Kit</a></li>
<li><a href="http://www.xilinx.com/products/design-tools/vivado/">Xilinx Vivado</a></li>
<li><a href="http://www.cypress.com/documentation/development-kitsboards/cyusb3kit-003-ez-usb-fx3-superspeed-explorer-kit">CYUSB3KIT-003 EZ-USB® FX3™ SuperSpeed Explorer Kit</a></li>
<li><a href="http://www.cypress.com/documentation/development-kitsboards/cyusb3acc-005-fmc-interconnect-board-ez-usb-fx3-superspeed">CYUSB3ACC-005 FMC Interconnect Board for the EZ-USB® FX3™ SuperSpeed Explorer Kit</a></li>
</ul>
<p>To prepare, plug the Explorer Kit into the FMC Interconnect Board. <em>Do not</em> connect the two boards to the VCU108 FPGA board just yet.</p>
<h2>Download and compile glip </h2>
<p>If you have not done this before you need to download and build glip: </p><pre class="fragment">git clone https://github.com/TUM-LIS/glip.git
cd glip
./autogen.sh
mkdir build; cd build
../configure --enable-cypressfx3
make
sudo make install
</pre><h2>Synthesize the design </h2>
<p>Synthesize the example design with Xilinx Vivado. </p><pre class="fragment">cd GLIP_SOURCES/src/backend_cypressfx3/logic/demo/vcu108_loopback
make vivado-project-32
vivado vcu108_loopback_32/vcu108_loopback.xpr
</pre><p>In Vivado run the implementation and generate the bitstream.</p>
<h2>Configure the FPGA </h2>
<p>Before you turn on the VCU108 board, <em>disconnect</em> the FMC Interconnect board together with the FX3 board.</p>
<p>When the bitstream has been succesfully generated, open the Hardware Manager in Vivado, turn the board on and program the FPGA.</p>
<h2>Flash the Cypress FX3 firmware </h2>
<p>Before being used the first time, the FX3 chip must be flashed with our firmware. Please refer to <a class="el" href="group__backend__cypressfx3-fw.html">Cypress FX3 Firmware</a> for instructions how to do that. It's best to program the firmware to the EEPROM to save yourself from the hassle of doing these steps again.</p>
<h2>Check the jumpers on the FX3 board </h2>
<p>The FX3 board contains three jumpers to configure it. Ensure that you have set the jumpers to the following settings:</p>
<ul>
<li>Jumper J2 (VIO1-3) is not set (open)</li>
<li>Jumper J3 (VBUS JUMPER) is set (closed)</li>
<li>Jumper J4 (PMODE) is not set (open)</li>
<li>Jumper J5 (SRAM ENABLE) is not set (open)</li>
</ul>
<p>Jumper J2 sets the I/O voltage to 3.3V. The KC705 should always operate with its FMC I/Os set to 3.3V. Otherwise it does not create a clean clock signal for frequencies greater than ~40MHz. With the I/Os set to 3.3V the FX3 can run at 100MHz, but frequencies between 63MHz and 85MHz should be avoided.</p>
<h2>Connect the FX3 board to the FPGA </h2>
<p>While the FPGA is board is powered-on and flashed with the bitstream, plug the FX3 board into the "FMC HPC1" (J2) connector on the VCU108 board. (It's the one closer to the power plug.)</p>
<h2>Execute the loopback measurement tool </h2>
<p>As final (and long awaited) step, execute the GLIP tool "Loopback Measure" that measures the loopback performance by sending data to the device and reading back from it. Run the loopback measurement tool like this to transfer 10 GB of data to the FPGA and back. </p><pre class="fragment">glip_loopback_measure -b cypressfx3 -s 1000000000
</pre><p>If you plugged the FX3 chip into an USB 3.0 port on your PC, you should get a performance of around 190 MByte/s bidirectional (i.e. 190 MByte/s sending and 190 MByte/s receiving at the same time), or 3 GBps overall (net). Note, however, that this data rate assumes that only this test occupies the USB bus on the host. If other transfers are active at the same time (e.g. an external hard disk you're transferring data to), the data rate will be lower. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu May 4 2017 22:04:12 for glip by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
