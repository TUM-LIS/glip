<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>glip: ZTEX USB-FPGA 1.15 JTAG Loopback Demo</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">glip
   &#160;<span id="projectnumber">0.1.0-dev</span>
   </div>
   <div id="projectbrief">The Generic Logic Interfacing Project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>GLIP&#160;Introduction</span></a></li>
      <li><a href="examples.html"><span>Demos</span></a></li>
      <li><a href="modules.html"><span>Documentation</span></a></li>
      <li><a href="download.html"><span>Download</span></a></li>
      <li><a href="contact.html"><span>Contact</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__backend__jtag-examples-ztex__115__loopback.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">ZTEX USB-FPGA 1.15 JTAG Loopback Demo<div class="ingroups"><a class="el" href="group__backend.html">Backends</a> &raquo; <a class="el" href="group__backend__jtag.html">JTAG</a> &raquo; <a class="el" href="group__backend__jtag-logic.html">JTAG FPGA Logic</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>This demo shows how to use the GLIP JTAG backend. The FGPA is only used as a loopback device, which sends back all data it receives.</p>
<h2>Prerequisites </h2>
<p>Before you get started with this demo, make sure that you have the necessary hardware ready and the software installed and configured.</p>
<ul>
<li>a <a href="http://www.ztex.de/usb-fpga-1/usb-fpga-1.15.d.html">ZTEX USB-FPGA 1.15d</a> board</li>
<li>an <a href="https://www.olimex.com/Products/ARM/JTAG/ARM-USB-TINY-H/">Olimex TINY-USB-H</a> JTAG adapter</li>
<li>have GLIP compiled and installed with the <code>--enable-jtag</code> configure option</li>
</ul>
<p>You also need a synthesis toolchain. In this demo, we use <a href="http://www.xilinx.com/products/design-tools/ise-design-suite/">Xilinx ISE</a> (the free WebPack edition is sufficient), together with Synopsys Synplify (commercial license required). It should be possible without any trouble to use ISE alone.</p>
<h2>Synthesize the design </h2>
<p>A complete Makefile is included with this demo. To synthesize and flash the design, run </p><pre class="fragment">$&gt; make synplify
$&gt; make bitstream
</pre><h2>Hardware setup </h2>
<p>The JTAG adapter is connected to standard I/O pins of the FPGA, which are defined in the <code>boards/ztex_115/jtag.ucf</code> constraints file.</p>
<p>For this demo, connect the Olimex TINY-USB-H device to the FPGA using the pin mapping in the table below. If those pins are not available in your design, you can use any other I/O pin by modifying the constraints file accordingly.</p>
<table class="doxtable">
<tr>
<th>JTAG Name </th><th>ZTEX 1.15d pin </th><th>FPGA pad </th><th>Olimex pin  </th></tr>
<tr>
<td>tck </td><td>B27 </td><td>D7 </td><td>9 </td></tr>
<tr>
<td>tms </td><td>A26 </td><td>A8 </td><td>7 </td></tr>
<tr>
<td>tdi </td><td>B26 </td><td>B8 </td><td>5 </td></tr>
<tr>
<td>tdo </td><td>B29 </td><td>C5 </td><td>13 </td></tr>
</table>
<p>All other JTAG pins (especially TRST) are not used, as their functionality can be emulated using the other signals.</p>
<p>Further reading:</p><ul>
<li><a href="https://www.olimex.com/Products/ARM/JTAG/_resources/openocd-jtag-layout.png">Olimex adapter pin mapping</a></li>
<li><a href="http://www.ztex.de/downloads/usb-fpga-1.xls">ZTEX pin mapping</a></li>
</ul>
<h2>Configure the FPGA </h2>
<p>Two options exist to load the bitstream onto the FPGA on the ZTEX boards: either by using the standard Xilinx tools ("Program Device" from Xilinx Impact), which load the bitstream over JTAG, or by using the ZTEX tools, which load the bitstream through a USB connection.</p>
<dl class="section note"><dt>Note</dt><dd>The bitstream is loaded through the FPGA's hardware JTAG port, which has nothing to do with the JTAG port the GLIP communication happens over. If you flash the bitstream over JTAG, and also use the GLIP JTAG, you will have two independent JTAG cables connected to your device!</dd></dl>
<h3>Using the ZTEX tools</h3>
<p>If you use the board for the first time, you need to flash the Cypress FX2 USB chip first with the ZTEX firmware, and then use the <code>FWLoader</code> utility to configure the FPGA. Please consult the <a class="el" href="group__backend__cypressfx2-examples-ztex__213__loopback.html">ZTEX USB-FPGA 2.13 Loopback Demo</a> for details. Instead of the GLIP firmware which contains additional functionality for the USB data transfer (unused in this demo), you can also use the <a href="http://wiki.ztex.de/doku.php?id=en:ztex_boards:ztex_fpga_boards:standalone">standalone firmware from ZTEX</a>.</p>
<p>Note that this method requires a USB connection between the ZTEX board and the host PC.</p>
<p>To flash the device, run </p><pre class="fragment">$&gt; make flash
</pre><h3>Using Xilinx Impact</h3>
<p>This method requires a JTAG connection between the board and your PC using a standard JTAG adapter. More information is available from <a href="http://wiki.ztex.de/doku.php?id=en:ztex_boards:ztex_fpga_boards:jtag">ZTEX</a> and in the ISE/Impact documentation from Xilinx.</p>
<h2>Execute the loopback measurement tool </h2>
<p>Execute the GLIP tool "Loopback Mesasure" that measures the loopback performance. </p><pre class="fragment">$&gt; glip_loopback_measure -b jtag -o oocd_conf_interface=interface/ftdi/olimex-arm-usb-tiny-h.cfg</pre></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jan 11 2017 15:51:41 for glip by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
