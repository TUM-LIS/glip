<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>glip: ZTEX USB-FPGA 2.13 Loopback Demo</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">glip
   &#160;<span id="projectnumber">0.1.0-dev</span>
   </div>
   <div id="projectbrief">The Generic Logic Interfacing Project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>GLIP&#160;Introduction</span></a></li>
      <li><a href="modules.html"><span>Documentation</span></a></li>
      <li><a href="download.html"><span>Download</span></a></li>
      <li><a href="contact.html"><span>Contact</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__backend__cypressfx2-examples-ztex__213__loopback.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">ZTEX USB-FPGA 2.13 Loopback Demo<div class="ingroups"><a class="el" href="group__backend.html">Backends</a> &raquo; <a class="el" href="group__backend__cypressfx2.html">Cypress FX2</a> &raquo; <a class="el" href="group__backend__cypressfx2-logic.html">Cypress FX2 FPGA Logic</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>This demo implements a loopback in the device. The LEDs of the debug board (LED2) are driven by a counter and indicate the speed and amount of transfers. You need to set the DIP switches 3 and 4 to ON to have the LEDs connected.</p>
<h2>Prerequisites </h2>
<p>Before you get started with this demo, make sure that you have the necessary hardware ready and the software installed and configured.</p>
<ul>
<li>a <a href="http://www.ztex.de/usb-fpga-2/usb-fpga-2.13.e.html">ZTEX USB-FPGA 2.13</a> board</li>
<li>the <a href="http://www.ztex.de/firmware-kit/">ZTEX SDK</a></li>
<li>have GLIP compiled and installed</li>
</ul>
<p>You also need a synthesis toolchain.</p><ul>
<li>In this demo, we support <em>either</em> <a href="http://www.xilinx.com/products/design-tools/vivado/">Xilinx Vivado</a> (the free WebPack edition is sufficient), version 2014.1 or higher</li>
<li><em>or</em> <a href="http://www.xilinx.com/products/design-tools/ise-design-suite/">Xilinx ISE</a> (again, the free WebPack edition is sufficient), together with Synopsys Synplify (commercial license required)</li>
</ul>
<h2>Synthesize the design </h2>
<p>In the end we want to get from the Verilog sources to a bitstream. In this demo, we show two ways of doing that: using Xilinx Vivado and using Synopsys Synplify together with Xilinx ISE. The other two options, using Synplify with Vivado and using ISE alone should be possible as well but are not shown here.</p>
<h3>Vivado</h3>
<ul>
<li><p class="startli">In a console, type </p><pre class="fragment">$&gt; cd GLIP_DIR/src/backend_cypressfx2/logic/demo/ztex_213_loopback
$&gt; vivado -source loopback_vivado.tcl
</pre><p class="startli">You need to replace <code>GLIP_DIR</code> with the directory containing your GLIP checkout.</p>
</li>
<li>Click on <code>Generate Bitstream</code>. Answer <code>Yes</code> when asked to run other steps before the bitstream generation.</li>
<li>The bitstream is located at <code>loopback/loopback.runs/impl_1/ztex_213_loopback.bit</code></li>
</ul>
<h3>Synplify and ISE</h3>
<ul>
<li>Open Synplify</li>
<li>Click on the left side on <code>Open Project...</code> -&gt; <code>Existing Project...</code>, select the <code>loopback_synplify.prj</code> file and click on <code>Open</code></li>
<li>Click on <code>Run</code> in the top-left corner to synthesize the design. Wait for it to finish.</li>
<li>Generate the bitstream by running on the console <pre class="fragment">$&gt; cd GLIP_DIR/src/backend_cypressfx2/logic/demo/ztex_213_loopback
$&gt; bitgen -w rev_1/pr_1/ztex_213_loopback.ncd
</pre></li>
<li>The bitstream is located at <code>rev_1/pr_1/ztex_213_loopback.bit</code>.</li>
</ul>
<h2>Build and flash the FX2 firmware </h2>
<p>The Cypress FX2 chip on the ZTEX boards needs firmware to work properly. Connect the board to your PC and execute the following steps to build and flash the firmware. </p><pre class="fragment">$&gt; cd GLIP_DIR/src/backend_cypressfx2/fw/ztex
$&gt; make fw-213.ihx
$&gt; make flash-213
</pre><p>The firmware is written to the EEPROM and does not need to be reloaded after you unplug your board (until you have overwritten it).</p>
<h2>Configure the FPGA </h2>
<p>When the bitstream has been succesfully generated, you can configure the FPGA with through the Cypress FX2 chip using the ZTEX tools. Adjust the path to the bitstream as given in the section above. </p><pre class="fragment">$&gt; FWLoader -c -rf -uf PATH/TO/BITSTREAM.bit
</pre><h2>Execute the loopback measurement tool </h2>
<p>Execute the GLIP tool "Loopback Mesasure" that measures the loopback performance. </p><pre class="fragment">$&gt; glip_loopback_measure -b cypressfx2 -ousb_vid=0x221a,usb_pid=0x0100
</pre><p>The performance should be around 20 MByte/s bidirectional. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jul 8 2015 10:04:03 for glip by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
